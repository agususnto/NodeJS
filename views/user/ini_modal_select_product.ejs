<!-- Modal untuk Select Product -->
<!-- <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="productModalLabel">Select Product</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div> -->
            <!-- Input untuk pencarian -->
            <!-- <div class="modal-body">
                <table class="table table-bordered" id="productTable">
                    <thead>
                        <tr>
                            <th></th>
                            <th>SKU</th>
                            <th>NAME</th>
                            <th>PRICE</th>
                            <th>STOCK</th>
                            <th>CATEGORY</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% products.forEach(product => { %>
                            <tr data-product-id="<%= product._id %>">
                                <td><input type="checkbox" class="product-checkbox" data-product-id="<%= product._id %>"data-product-name="<%= product.name %>"></td>
                                <td><%= product.sku %></td>
                                <td><%= product.name %></td>
                                <td><%= product.price %></td>
                                <td><%= product.stock %></td>
                                <td><%= product.category %></td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="selectUsers()">Select</button>
            </div>
        </div>
    </div>
</div> -->

<!-- Tautan jQuery -->
<!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> -->

<!-- Tautan DataTables JS -->
<!-- <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script> -->

<!-- Tautan Select2 JS -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/js/select2.min.js"></script> -->

<!-- Tautan Bootstrap JS -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    $(document).ready(function () {
        // Inisialisasi DataTable pada elemen tabel
        var productTable = $('#productTable').DataTable({
            "paging": false,
            "columns": [
                { 
                    "data": null, 
                    "defaultContent": "<input type='checkbox' class='product-checkbox'/>" 
                },
                { "data": "sku" },
                { "data": "name" },
                { "data": "price" },
                { "data": "stock" },
                { "data": "category"}
            ],
            "select": {
                style: 'multi',
                selector: 'td:first-child'
            },
        });
    
        // Menangani pemilihan baris saat mengklik checkbox
        $('#productTable tbody').on('click', 'input.product-checkbox', function () {
            var checkbox = $(this);
            var row = checkbox.closest('tr');
    
            // Panggil fungsi untuk menangani pemilihan baris
            handleRowSelection(row);
        });
    
        // Menangani pemilihan baris saat mengklik seluruh baris
        $('#productTable tbody').on('click', 'tr', function () {
            var checkbox = $(this).find('input.product-checkbox');
            checkbox.prop('checked', !checkbox.prop('checked')).trigger('change');
    
            // Panggil fungsi untuk menangani pemilihan baris
            handleRowSelection($(this));
        });
    });
    
    function selectProduct(productId, productName) {
        var row = $(`tr[data-product-id='${productId}']`);
        var checkbox = row.find('input.product-checkbox');
        checkbox.prop('checked', !checkbox.prop('checked')).trigger('change');
    
        // Panggil fungsi untuk menangani pemilihan baris
        handleRowSelection(row);
    }
    
    function handleRowSelection(row) {
        var checkbox = row.find('input.product-checkbox');
        var selectedProducts = [];
    
        // Toggle seleksi baris
        if (checkbox.prop('checked')) {
            row.addClass('selected');
        } else {
            row.removeClass('selected');
        }
    
        // Dapatkan semua baris yang dipilih
        $('#productTable tbody tr.selected').each(function () {
            var productId = $(this).data('product-id');
            var productName = $(this).find('td:eq(2)').text();
            selectedProducts.push({ id: productId, name: productName });
        });
    
        // Setel nilai pada input productIds
        $('#productIds').val(selectedProducts.map(product => product.name).join(',')).trigger('change');
    }
</script> -->